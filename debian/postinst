#!/bin/sh

set -e

chmod 755 /usr/share/python-support/surfids-sensor/sensor/bin/sensor-manager.py
if [ -e "/etc/inittab" ]; then
    if [ ! -e "/etc/backup.inittab" ]; then
        mv -f /etc/inittab /etc/backup.inittab
        sed 's/.*tty1/1:2345:respawn:\/usr\/sbin\/sensor-manager <\/dev\/tty1 >\/dev\/tty1 2>\&1/' /etc/backup.inittab > /etc/inittab
    fi
fi
if [ -e "/etc/event.d/" ]; then
    mv -f /var/lib/surfids/tty1.conf /etc/event.d/tty1
else
    rm -f /var/lib/surfids/tty1.conf
fi

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

echo "1) Add your tunnel server ca.crt to /etc/surfids/"
echo "2) Configure the following files:"
echo "    /etc/surfids/surfids.conf"
echo "    /etc/surfids/openvpn.conf"
echo "3) Reboot your machine to startup the sensor environment!"

exit 0
